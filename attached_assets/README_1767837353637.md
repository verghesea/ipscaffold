# IP Scaffold - Complete Build Documentation

## Quick Start for Replit AI

This repository contains complete documentation to build **IP Scaffold MVP** - a tool that transforms patent PDFs into business-ready artifacts using AI.

---

## What This App Does

**Input:** Upload a patent PDF
**Output:** 3 AI-generated business artifacts:
1. **ELIA15** - Simplified explanation (Explain Like I'm 15)
2. **Business Narrative** - Investor-ready pitch deck content
3. **Golden Circle** - WHY/HOW/WHAT framework

**User Flow:**
1. User uploads patent PDF (no account required)
2. System generates ELIA15 and shows it
3. User enters email to see remaining artifacts
4. User receives magic link email
5. User clicks link → logged in → sees dashboard
6. User views all 3 artifacts and downloads as PDF/DOCX/TXT

---

## Documentation Structure

### 1. **PRD.md** (Product Requirements Document)
**Read this first** - Complete product specification including:
- User personas and journeys
- Feature requirements
- Success metrics
- AI prompt templates (ELIA15, Business Narrative, Golden Circle)
- Error handling
- Security requirements

### 2. **DATABASE_SCHEMA.md**
Complete database design:
- 5 tables: users, patents, artifacts, magic_tokens, credit_transactions
- SQL CREATE statements
- SQLAlchemy model definitions
- Indexes and constraints
- Sample queries

### 3. **API_SPECIFICATION.md**
All HTTP endpoints:
- Public routes (landing, upload, preview)
- Auth routes (magic link verification)
- Protected routes (dashboard, patent detail, downloads)
- Request/response formats
- Error handling
- Rate limiting

### 4. **IMPLEMENTATION_GUIDE.md**
Step-by-step build instructions:
- Project structure
- Phase-by-phase implementation
- Configuration setup
- Deployment checklist

### 5. **CODE_EXAMPLES.md**
Complete working code for:
- AI generator service (Anthropic Claude integration)
- PDF parser service
- Document generator (PDF/DOCX/TXT)
- All route handlers
- Email templates

### 6. **ADMIN_DASHBOARD.md**
Admin dashboard specification:
- Admin authentication
- User management view
- Patent analytics
- Usage analytics and charts
- System monitoring
- CSV exports
- Audit logging

### 7. **ADMIN_TEMPLATES.md** (Basic Tailwind Version)
Ready-to-use admin HTML templates:
- Admin login page
- Dashboard with key metrics
- User list with search/sort
- Analytics with Chart.js visualizations
- Complete responsive layouts

### 8. **FRONTEND_REFINED_EDITORIAL.md** (Part 1)
Redesigned frontend with "Refined Editorial" aesthetic:
- Complete design system (typography, colors, spacing, animations)
- Global CSS with custom properties
- Base template with navigation and footer
- Landing page with hero and upload section
- Beautiful form interactions

### 9. **FRONTEND_REFINED_EDITORIAL_PART2.md**
User-facing templates continuation:
- Preview page with ELIA15 display
- Email sent confirmation
- Dashboard with portfolio view
- Patent detail page with all artifacts
- JavaScript enhancements

### 10. **FRONTEND_ADMIN_EDITORIAL.md**
Admin dashboard with refined editorial styling:
- Admin base template and navigation
- Sophisticated login page
- Dashboard with data visualizations
- User management interface
- Analytics with styled Chart.js graphs

### 11. **DESIGN_IMPLEMENTATION_GUIDE.md**
Complete guide to implementing the refined editorial design:
- Quick start instructions
- Design system reference (typography, colors, spacing)
- Component examples
- Layout patterns
- Animation guidelines
- Responsive breakpoints
- Chart styling
- Production optimizations
- Customization guide
- Troubleshooting

### 12. **INSTRUCTIONS_FOR_REPLIT.md** ⭐ START HERE FOR REPLIT AI
Comprehensive instructions for Replit AI to build the entire application:
- Implementation order (7 phases)
- Critical configuration
- API keys needed
- Testing checklist
- Common issues & solutions
- Document reference map
- Success criteria

### 13. **QUICK_START_REPLIT.md** ⭐ QUICK REFERENCE
Quick checklist and reference guide:
- What to tell Replit AI
- Files checklist
- Environment variables template
- Testing flow
- Cost breakdown
- Success criteria

---

## Tech Stack Summary

**Backend:**
- Python 3.11+
- Flask (web framework)
- SQLAlchemy (ORM)
- PostgreSQL (database)

**AI:**
- Anthropic Claude Sonnet 3.5

**PDF Processing:**
- pdfplumber (parsing)
- WeasyPrint (PDF generation)
- python-docx (DOCX generation)

**Email:**
- SendGrid (magic links)

**Frontend:**
- Jinja2 templates
- Tailwind CSS
- Vanilla JavaScript

---

## Environment Variables Required

Create a `.env` file with:

```bash
# Database (Replit provides automatically)
DATABASE_URL=postgresql://...

# API Keys
ANTHROPIC_API_KEY=your_key_here
SENDGRID_API_KEY=your_key_here
SENDGRID_FROM_EMAIL=noreply@yourdomain.com

# Flask
FLASK_SECRET_KEY=generate_random_32_byte_hex
FLASK_ENV=development

# App
APP_URL=https://your-app.repl.co
MAX_UPLOAD_SIZE_MB=10
```

---

## Build Order for Replit AI

Follow this sequence:

### Phase 1: Setup (30 min)
1. Create project structure (see IMPLEMENTATION_GUIDE.md)
2. Install dependencies (requirements.txt)
3. Configure .env file
4. Set up PostgreSQL

### Phase 2: Database Models (1 hour)
1. Create all models in `models/` directory
2. Initialize database
3. Test database connection

### Phase 3: Services (2 hours)
1. PDF parser service
2. AI generator service
3. Email service
4. Document generator service
5. Credit manager service

### Phase 4: Routes (2 hours)
1. Public routes (upload flow)
2. Auth routes (magic links)
3. Dashboard routes (viewing & downloads)

### Phase 5: Frontend (2 hours)
1. Base template
2. Landing page
3. Preview page
4. Dashboard
5. Patent detail page
6. Email template

### Phase 6: Testing (1 hour)
1. Test with sample patent PDF
2. Verify full user flow
3. Test downloads (PDF/DOCX/TXT)
4. Test credit system

**Total Time: ~8 hours**

---

## Key Files to Create

```
app.py                          # Main Flask application
config.py                       # Configuration
requirements.txt                # Dependencies
.env                           # Environment variables

models/
  database.py                   # DB connection
  user.py                       # User model
  patent.py                     # Patent model
  artifact.py                   # Artifact model
  magic_token.py                # Auth token model
  credit_transaction.py         # Credit tracking model

services/
  pdf_parser.py                 # PDF parsing
  ai_generator.py               # Claude AI integration
  email_service.py              # SendGrid emails
  document_generator.py         # PDF/DOCX/TXT generation
  credit_manager.py             # Credit system

routes/
  public.py                     # Public routes
  auth.py                       # Authentication
  dashboard.py                  # Protected routes

templates/
  base.html                     # Base layout
  landing.html                  # Upload page
  preview.html                  # ELIA15 preview
  email_sent.html               # Confirmation
  dashboard.html                # User dashboard
  patent_detail.html            # Artifact viewer
  credits.html                  # Credit history
  email/magic_link.html         # Email template
  errors/404.html, 403.html, 500.html

static/
  css/style.css                 # Custom styles
  js/main.js                    # JavaScript
```

---

## Critical Implementation Notes

### 1. AI Prompts
All prompts are in **PRD.md** under "AI Generation Specifications". Copy these exactly for:
- ELIA15
- Business Narrative
- Golden Circle

### 2. Background Processing
The Business Narrative and Golden Circle are generated in a background thread after the user submits their email. This keeps the initial upload fast (only ELIA15 blocks).

**Implementation:**
```python
from threading import Thread

thread = Thread(target=generate_remaining_artifacts, args=(patent_id,))
thread.daemon = True
thread.start()
```

### 3. Credit System
- New users: 100 free credits
- Cost per patent: 10 credits
- Check credits BEFORE processing
- Refund if processing fails

### 4. Magic Link Auth
- Tokens expire in 1 hour
- One-time use only
- Use `secrets.token_urlsafe(32)` for generation

### 5. PDF Parsing
US patents have predictable structure. Extract:
- Title (after "Title:" or second line)
- Inventors (after "Inventors:")
- Assignee (after "Assignee:")
- Filing date (after "Filed:")
- Full text (all pages concatenated)

---

## Testing Checklist

Before considering MVP complete:

- [ ] User can upload patent PDF
- [ ] ELIA15 generates and displays
- [ ] Email gate appears
- [ ] Magic link email sends
- [ ] User can click link and log in
- [ ] Dashboard shows patent list
- [ ] Patent detail shows all 3 artifacts
- [ ] PDF download works
- [ ] DOCX download works
- [ ] TXT download works
- [ ] Credit system deducts correctly
- [ ] User can upload second patent
- [ ] Error handling works (bad PDF, failed AI call)

---

## Common Issues & Solutions

**Issue:** PDF parsing fails
**Solution:** Check if PDF is text-based (not scanned image). Use pdfplumber's `.extract_text()` method.

**Issue:** Anthropic API errors
**Solution:** Check API key, verify account has credits, check rate limits.

**Issue:** Email not sending
**Solution:** Verify SendGrid API key, check sender email is verified in SendGrid.

**Issue:** Database connection fails
**Solution:** Check DATABASE_URL format, ensure PostgreSQL is running in Replit.

**Issue:** Background thread not completing
**Solution:** Check app.app_context() is used, verify database session handling.

---

## Cost Estimates

**Per Patent Processing:**
- ELIA15: ~$0.09 (AI cost)
- Business Narrative: ~$0.12 (AI cost)
- Golden Circle: ~$0.06 (AI cost)
- **Total AI cost: ~$0.27**

**Pricing:**
- User pays: $2 per patent (10 credits @ $20/100 credits)
- Margin: ~$1.73 per patent

**Other costs:**
- SendGrid: Free (up to 100 emails/day)
- Replit hosting: Free tier or ~$7/month
- PostgreSQL: Free tier or ~$10/month

---

## Deployment to Replit

1. Click "Run" to start Flask app
2. Replit will detect it's a Flask app
3. Set environment variables in Replit Secrets:
   - ANTHROPIC_API_KEY
   - SENDGRID_API_KEY
   - FLASK_SECRET_KEY
4. PostgreSQL database is auto-provisioned
5. App will be available at `https://your-app.repl.co`

---

## Next Steps After MVP

**Phase 2 Features:**
- Stripe payment integration for credit purchases
- Empathy Map artifact (4th output)
- Lean Canvas artifact (5th output)
- Support for research papers (not just patents)

**Phase 3 Features:**
- Team accounts
- Bulk upload via USPTO patent numbers
- API access
- White-label for TTOs

---

## Support & Questions

For build questions, refer to:
1. **PRD.md** for "what" and "why"
2. **DATABASE_SCHEMA.md** for data structure
3. **API_SPECIFICATION.md** for endpoints
4. **CODE_EXAMPLES.md** for working code
5. **IMPLEMENTATION_GUIDE.md** for step-by-step instructions

---

## Success Metrics (3 Month Target)

- 100 patents processed
- 50 registered users
- 80% completion rate
- 70% return rate
- <5% error rate
- 95% uptime

---

**Ready to Build!**

Start with IMPLEMENTATION_GUIDE.md Phase 1 and work sequentially through all phases. All code and specifications are provided in the supporting documents.

Good luck building IP Scaffold!
